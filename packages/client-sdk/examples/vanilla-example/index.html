<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Track SDK - Vanilla JS Example</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }

    .container {
      background: white;
      border-radius: 8px;
      padding: 30px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    h1 {
      color: #333;
      margin-top: 0;
    }

    h2 {
      color: #666;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
      margin-top: 30px;
    }

    .section {
      margin: 20px 0;
    }

    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 14px;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      background: #007bff;
      color: white;
      transition: background 0.2s;
    }

    button:hover {
      background: #0056b3;
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    button.danger {
      background: #dc3545;
    }

    button.danger:hover {
      background: #c82333;
    }

    button.success {
      background: #28a745;
    }

    button.success:hover {
      background: #218838;
    }

    .input-group {
      margin: 15px 0;
    }

    label {
      display: block;
      margin-bottom: 5px;
      color: #666;
      font-weight: 500;
    }

    input,
    select {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }

    input:focus,
    select:focus {
      outline: none;
      border-color: #007bff;
    }

    .status {
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      font-weight: 500;
    }

    .status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .status.info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }

    .log {
      margin-top: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      white-space: pre-wrap;
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #dee2e6;
    }

    .log-entry {
      margin: 2px 0;
    }

    .log-entry.error {
      color: #dc3545;
    }

    .log-entry.success {
      color: #28a745;
    }

    .log-entry.info {
      color: #007bff;
    }

    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .info-box {
      background: #e7f3ff;
      border-left: 4px solid #007bff;
      padding: 15px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .info-box code {
      background: rgba(0, 0, 0, 0.05);
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>ğŸš€ Track SDK - Vanilla JS ç¤ºä¾‹</h1>

    <div class="info-box">
      <strong>ğŸ“ è¯´æ˜ï¼š</strong>
      <ul style="margin: 10px 0; padding-left: 20px;">
        <li>æ­¤ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨åŸç”Ÿ JavaScript é›†æˆ Track SDK</li>
        <li>ç¡®ä¿å·²æ„å»º SDKï¼ˆè¿è¡Œ <code>npm run build</code>ï¼‰</li>
        <li><strong>é‡è¦ï¼š</strong>è¯·åœ¨ä¸‹æ–¹é…ç½®ä¸­å¡«å†™ä½ çš„æœåŠ¡ç«¯åœ°å€ï¼ˆEndpointï¼‰ï¼Œä¾‹å¦‚ï¼š<code>http://localhost:8080</code> æˆ–
          <code>https://track.yourdomain.com</code></li>
        <li>å¦‚æœä½¿ç”¨æœ¬åœ°å¼€å‘ï¼Œç‚¹å‡»"ä¸€é”®å¡«å……æœ¬åœ°"æŒ‰é’®å¿«é€Ÿé…ç½®</li>
        <li>æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†æ—¥å¿—</li>
      </ul>
    </div>

    <!-- SDK é…ç½® -->
    <div class="section">
      <h2>âš™ï¸ SDK é…ç½®</h2>
      <div class="input-group"
        style="background: #fff3cd; padding: 15px; border-radius: 4px; border-left: 4px solid #ffc107;">
        <label for="endpoint" style="font-weight: bold; color: #856404;">
          ğŸŒ æœåŠ¡ç«¯åœ°å€ (Endpoint) <span style="color: #dc3545;">*å¿…å¡«</span>:
        </label>
        <input type="text" id="endpoint" value="" placeholder="http://localhost:8080"
          style="border: 2px solid #ffc107; font-weight: 500;">
        <small style="color: #856404; display: block; margin-top: 5px;">
          ç¤ºä¾‹ï¼š<code>http://localhost:8080</code>ï¼ˆæœ¬åœ°å¼€å‘ï¼‰æˆ– <code>https://track.yourdomain.com</code>ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
        </small>
      </div>
      <div class="input-group">
        <label for="appId">åº”ç”¨ ID (App ID):</label>
        <input type="text" id="appId" value="vanilla-example-app-id" placeholder="vanilla-example-app-id">
      </div>
      <div class="input-group">
        <label for="appName">é¡¹ç›®å (App Nameï¼Œå¯é€‰):</label>
        <input type="text" id="appName" value="Vanilla Example" placeholder="ä¸å¡«åˆ™ä½¿ç”¨ App ID">
      </div>
      <div class="input-group">
        <label for="userId">ç”¨æˆ· ID (User ID):</label>
        <input type="text" id="userId" value="user-123" placeholder="user-123">
      </div>
      <div class="input-group">
        <label for="sessionTTL">Session æœ‰æ•ˆæœŸ (åˆ†é’Ÿ):</label>
        <input type="number" id="sessionTTL" value="1440" placeholder="1440">
      </div>
      <div class="button-group">
        <button id="init-btn" class="success">åˆå§‹åŒ– SDK</button>
        <button id="start-btn" disabled>å¯åŠ¨è¿½è¸ª</button>
        <button id="stop-btn" disabled class="danger">åœæ­¢è¿½è¸ª</button>
        <button id="quick-fill-btn" title="å¡«å……æœ¬åœ°å¼€å‘é…ç½®">ä¸€é”®å¡«å……æœ¬åœ°</button>
        <button id="random-user-btn" title="éšæœºä¸€ä¸ªç”¨æˆ·ID">éšæœºç”¨æˆ·</button>
      </div>
      <div id="status"></div>
    </div>

    <!-- è‡ªåŠ¨é‡‡é›†åŠŸèƒ½ -->
    <div class="section">
      <h2>ğŸ“Š è‡ªåŠ¨é‡‡é›†åŠŸèƒ½</h2>
      <p>ä»¥ä¸‹åŠŸèƒ½åœ¨ SDK å¯åŠ¨åä¼šè‡ªåŠ¨å¯ç”¨ï¼š</p>
      <ul>
        <li>âœ… <strong>PV (é¡µé¢æµè§ˆ)</strong> - è‡ªåŠ¨é‡‡é›†é¡µé¢è®¿é—®</li>
        <li>âœ… <strong>ç‚¹å‡»äº‹ä»¶</strong> - è‡ªåŠ¨é‡‡é›†ç”¨æˆ·ç‚¹å‡»è¡Œä¸º</li>
        <li>âœ… <strong>é¡µé¢åœç•™æ—¶é•¿</strong> - è‡ªåŠ¨é‡‡é›†é¡µé¢åœç•™æ—¶é—´</li>
        <li>âœ… <strong>æ€§èƒ½æŒ‡æ ‡</strong> - è‡ªåŠ¨é‡‡é›†é¡µé¢åŠ è½½æ€§èƒ½</li>
        <li>âœ… <strong>é”™è¯¯ç›‘æ§</strong> - è‡ªåŠ¨é‡‡é›† JavaScript é”™è¯¯</li>
      </ul>
      <div class="button-group">
        <button id="test-click-btn" disabled>æµ‹è¯•ç‚¹å‡»é‡‡é›†</button>
        <button id="test-pv-btn" disabled>æ‰‹åŠ¨è§¦å‘ PV</button>
        <button id="test-error-btn" disabled class="danger">è§¦å‘æµ‹è¯•é”™è¯¯</button>
        <button id="test-promise-error-btn" disabled class="danger">è§¦å‘ Promise é”™è¯¯</button>
        <label style="display:inline-flex;align-items:center;gap:6px;margin-left:10px;">
          <input type="checkbox" id="offline-toggle" disabled /> æ¨¡æ‹Ÿç¦»çº¿
        </label>
      </div>
    </div>

    <!-- è‡ªå®šä¹‰äº‹ä»¶ -->
    <div class="section">
      <h2>ğŸ¯ è‡ªå®šä¹‰äº‹ä»¶ä¸ŠæŠ¥</h2>
      <div class="input-group">
        <label for="eventId">äº‹ä»¶ ID:</label>
        <input type="text" id="eventId" value="button_click" placeholder="button_click">
      </div>
      <div class="input-group">
        <label for="eventProps">äº‹ä»¶å±æ€§ (JSON):</label>
        <input type="text" id="eventProps" value='{"buttonId": "test-btn", "category": "action"}'
          placeholder='{"key": "value"}'>
      </div>
      <div class="button-group">
        <button id="track-event-btn" disabled>ä¸ŠæŠ¥è‡ªå®šä¹‰äº‹ä»¶</button>
        <button id="batch-events-btn" disabled>æ‰¹é‡ä¸ŠæŠ¥ 3 ä¸ªäº‹ä»¶</button>
      </div>
    </div>

    <!-- SPA è·¯ç”±æµ‹è¯• -->
    <div class="section">
      <h2>ğŸ”„ SPA è·¯ç”±æµ‹è¯•</h2>
      <p>æµ‹è¯•å•é¡µåº”ç”¨çš„è·¯ç”±å˜åŒ–æ£€æµ‹ï¼š</p>
      <div class="button-group">
        <button id="push-state-btn" disabled>pushState è·¯ç”±</button>
        <button id="replace-state-btn" disabled>replaceState è·¯ç”±</button>
        <button id="hash-change-btn" disabled>Hash å˜åŒ–</button>
      </div>
    </div>

    <!-- ç‚¹å‡»è¿½è¸ªé…ç½® -->
    <div class="section">
      <h2>ğŸ–±ï¸ ç‚¹å‡»è¿½è¸ªé…ç½®</h2>
      <p>æ¼”ç¤ºç‚¹å‡»è¿½è¸ªçš„è¿‡æ»¤é…ç½®ï¼š</p>
      <div class="button-group">
        <button id="clickable-btn" disabled>å¯ç‚¹å‡»æŒ‰é’®</button>
        <button id="disabled-btn" disabled style="opacity: 0.5; cursor: not-allowed;">ç¦ç”¨æŒ‰é’®</button>
        <a href="#" id="link-test"
          style="margin: 5px; padding: 10px 20px; background: #007bff; color: white; text-decoration: none; border-radius: 4px; display: inline-block;">å¯ç‚¹å‡»é“¾æ¥</a>
      </div>
    </div>

    <!-- æ—¥å¿—è¾“å‡º -->
    <div class="section">
      <h2>ğŸ“‹ æ“ä½œæ—¥å¿—</h2>
      <div class="log" id="log"></div>
      <button id="clear-log-btn" style="margin-top: 10px;">æ¸…ç©ºæ—¥å¿—</button>
    </div>
  </div>

  <!-- å¼•å…¥ SDK -->
  <script src="../../dist/index.umd.js"></script>
  <script>
    // æ—¥å¿—ç®¡ç†
    const log = (message, type = 'info') => {
      const logEl = document.getElementById('log');
      const time = new Date().toLocaleTimeString();
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      entry.textContent = `[${time}] ${message}`;
      logEl.appendChild(entry);
      logEl.scrollTop = logEl.scrollHeight;
      console.log(`[${type.toUpperCase()}]`, message);
    };

    const clearLog = () => {
      document.getElementById('log').innerHTML = '';
    };

    // UI çŠ¶æ€ç®¡ç†
    const updateStatus = (message, type = 'info') => {
      const statusEl = document.getElementById('status');
      statusEl.className = `status ${type}`;
      statusEl.textContent = message;
    };

    const setButtonsEnabled = (enabled) => {
      const buttons = ['start-btn', 'stop-btn', 'test-click-btn', 'test-pv-btn',
        'test-error-btn', 'test-promise-error-btn', 'track-event-btn',
        'push-state-btn', 'replace-state-btn', 'hash-change-btn',
        'clickable-btn', 'disabled-btn'];
      buttons.forEach(id => {
        const btn = document.getElementById(id);
        if (btn) btn.disabled = !enabled;
      });
      document.getElementById('init-btn').disabled = enabled;
    };

    // æ£€æŸ¥ SDK æ˜¯å¦å¯ç”¨
    if (typeof window.Track === 'undefined') {
      updateStatus('âŒ SDK æœªåŠ è½½ï¼Œè¯·ç¡®ä¿å·²æ„å»º SDK (npm run build)', 'error');
      log('SDK æœªåŠ è½½ï¼Œè¯·æ£€æŸ¥è„šæœ¬è·¯å¾„', 'error');
    } else {
      log('SDK å·²åŠ è½½', 'success');
      // UMD æ ¼å¼å¯¼å‡ºï¼šwindow.Track æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å« Track ç±»ã€track å•ä¾‹å®ä¾‹ç­‰
      // ä½¿ç”¨ track å•ä¾‹å®ä¾‹ï¼ˆæ¨èä½¿ç”¨æ–¹å¼ï¼‰
      // window.Track.track æˆ– window.Track.default éƒ½æ˜¯å•ä¾‹å®ä¾‹
      window.TrackSDK = window.Track.track || window.Track.default;
      if (!window.TrackSDK || typeof window.TrackSDK.init !== 'function') {
        log('SDK å•ä¾‹å®ä¾‹æœªæ‰¾åˆ°ï¼Œæ£€æŸ¥ window.Track ç»“æ„', 'error');
        console.log('window.Track:', window.Track);
        console.log('window.Track.track:', window.Track.track);
        console.log('window.Track.default:', window.Track.default);
      } else {
        log('SDK å•ä¾‹å®ä¾‹å·²æ‰¾åˆ°', 'success');
      }
    }

    // åˆå§‹åŒ– SDK
    document.getElementById('init-btn').addEventListener('click', async () => {
      try {
        const endpoint = document.getElementById('endpoint').value.trim();
        const appId = document.getElementById('appId').value.trim();
        const userId = document.getElementById('userId').value.trim();
        const sessionTTL = parseInt(document.getElementById('sessionTTL').value) || 1440;

        if (!endpoint || !appId || !userId) {
          updateStatus('âŒ è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ', 'error');
          log('åˆå§‹åŒ–å¤±è´¥ï¼šç¼ºå°‘å¿…å¡«å­—æ®µ', 'error');
          return;
        }

        log('æ­£åœ¨åˆå§‹åŒ– SDK...', 'info');
        updateStatus('â³ æ­£åœ¨åˆå§‹åŒ–...', 'info');

        await window.TrackSDK.init({
          appId: appId,
          appName: document.getElementById('appName').value.trim() || undefined,
          userId: userId,
          userProps: {
            plan: 'premium',
            version: '1.0.0',
            source: 'vanilla-js-example'
          }
        }, {
          endpoint: endpoint,
          autoTrack: true,
          performance: true,
          errorTrack: true,
          sessionTTL: sessionTTL,
          debug: true,
          clickTrack: {
            enabled: true,
            debug: true
          }
        });

        log('SDK åˆå§‹åŒ–æˆåŠŸ', 'success');
        updateStatus('âœ… SDK åˆå§‹åŒ–æˆåŠŸï¼Œç‚¹å‡»"å¯åŠ¨è¿½è¸ª"å¼€å§‹ä½¿ç”¨', 'success');
        document.getElementById('start-btn').disabled = false;

      } catch (error) {
        log(`åˆå§‹åŒ–å¤±è´¥: ${error.message}`, 'error');
        updateStatus(`âŒ åˆå§‹åŒ–å¤±è´¥: ${error.message}`, 'error');
        console.error(error);
      }
    });

    // å¯åŠ¨è¿½è¸ª
    document.getElementById('start-btn').addEventListener('click', () => {
      try {
        window.TrackSDK.start();
        log('SDK å·²å¯åŠ¨ï¼Œå¼€å§‹è‡ªåŠ¨é‡‡é›†', 'success');
        updateStatus('âœ… SDK å·²å¯åŠ¨ï¼Œæ­£åœ¨é‡‡é›†æ•°æ®...', 'success');
        setButtonsEnabled(true);
      } catch (error) {
        log(`å¯åŠ¨å¤±è´¥: ${error.message}`, 'error');
        updateStatus(`âŒ å¯åŠ¨å¤±è´¥: ${error.message}`, 'error');
      }
    });

    // åœæ­¢è¿½è¸ª
    document.getElementById('stop-btn').addEventListener('click', async () => {
      try {
        await window.TrackSDK.stop();
        log('SDK å·²åœæ­¢', 'info');
        updateStatus('â¸ï¸ SDK å·²åœæ­¢', 'info');
        setButtonsEnabled(false);
        document.getElementById('start-btn').disabled = false;
      } catch (error) {
        log(`åœæ­¢å¤±è´¥: ${error.message}`, 'error');
      }
    });

    // æµ‹è¯•ç‚¹å‡»é‡‡é›†
    document.getElementById('test-click-btn').addEventListener('click', () => {
      log('ç‚¹å‡»äº†æµ‹è¯•æŒ‰é’®ï¼Œç‚¹å‡»äº‹ä»¶ä¼šè¢«è‡ªåŠ¨é‡‡é›†', 'info');
    });

    // æ‰‹åŠ¨è§¦å‘ PV
    document.getElementById('test-pv-btn').addEventListener('click', () => {
      // PV ä¼šåœ¨é¡µé¢åŠ è½½å’Œè·¯ç”±å˜åŒ–æ—¶è‡ªåŠ¨é‡‡é›†
      log('æ‰‹åŠ¨è§¦å‘ PVï¼ˆå®é™…ä¼šé€šè¿‡è·¯ç”±å˜åŒ–è§¦å‘ï¼‰', 'info');
      window.history.pushState({}, '', '/test-page');
      setTimeout(() => {
        window.history.pushState({}, '', '/');
      }, 1000);
    });

    // è§¦å‘æµ‹è¯•é”™è¯¯
    document.getElementById('test-error-btn').addEventListener('click', () => {
      log('è§¦å‘æµ‹è¯•é”™è¯¯...', 'info');
      try {
        throw new Error('è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é”™è¯¯ï¼Œç”¨äºéªŒè¯é”™è¯¯ç›‘æ§åŠŸèƒ½');
      } catch (e) {
        log('é”™è¯¯å·²æ•è·å¹¶ä¸ŠæŠ¥', 'error');
      }
    });

    // è§¦å‘ Promise é”™è¯¯
    document.getElementById('test-promise-error-btn').addEventListener('click', () => {
      log('è§¦å‘ Promise é”™è¯¯...', 'info');
      Promise.reject(new Error('è¿™æ˜¯ä¸€ä¸ªæœªå¤„ç†çš„ Promise é”™è¯¯')).catch(() => {
        log('Promise é”™è¯¯å·²æ•è·å¹¶ä¸ŠæŠ¥', 'error');
      });
    });

    // ä¸ŠæŠ¥è‡ªå®šä¹‰äº‹ä»¶
    document.getElementById('track-event-btn').addEventListener('click', () => {
      try {
        const eventId = document.getElementById('eventId').value.trim();
        const eventPropsText = document.getElementById('eventProps').value.trim();

        if (!eventId) {
          log('äº‹ä»¶ ID ä¸èƒ½ä¸ºç©º', 'error');
          return;
        }

        let eventProps = {};
        if (eventPropsText) {
          try {
            eventProps = JSON.parse(eventPropsText);
          } catch (e) {
            log('äº‹ä»¶å±æ€§ JSON æ ¼å¼é”™è¯¯', 'error');
            return;
          }
        }

        window.TrackSDK.track(eventId, eventProps);
        log(`ä¸ŠæŠ¥è‡ªå®šä¹‰äº‹ä»¶: ${eventId}`, 'success');
        log(`äº‹ä»¶å±æ€§: ${JSON.stringify(eventProps)}`, 'info');
      } catch (error) {
        log(`ä¸ŠæŠ¥å¤±è´¥: ${error.message}`, 'error');
      }
    });

    // SPA è·¯ç”±æµ‹è¯•
    document.getElementById('push-state-btn').addEventListener('click', () => {
      window.history.pushState({ page: 'test' }, 'Test Page', '/test-page');
      log('ä½¿ç”¨ pushState å¯¼èˆªåˆ° /test-page', 'info');
    });

    document.getElementById('replace-state-btn').addEventListener('click', () => {
      window.history.replaceState({ page: 'replace' }, 'Replace Page', '/replace-page');
      log('ä½¿ç”¨ replaceState å¯¼èˆªåˆ° /replace-page', 'info');
    });

    document.getElementById('hash-change-btn').addEventListener('click', () => {
      window.location.hash = '#test-section-' + Date.now();
      log('Hash å·²å˜åŒ–', 'info');
    });

    // ç‚¹å‡»è¿½è¸ªæµ‹è¯•
    document.getElementById('clickable-btn').addEventListener('click', () => {
      log('ç‚¹å‡»äº†å¯ç‚¹å‡»æŒ‰é’®ï¼ˆä¼šè¢«é‡‡é›†ï¼‰', 'info');
    });

    document.getElementById('disabled-btn').addEventListener('click', () => {
      log('ç‚¹å‡»äº†ç¦ç”¨æŒ‰é’®ï¼ˆä¸åº”è¯¥è¢«é‡‡é›†ï¼‰', 'info');
    });

    document.getElementById('link-test').addEventListener('click', (e) => {
      e.preventDefault();
      log('ç‚¹å‡»äº†é“¾æ¥ï¼ˆä¼šè¢«é‡‡é›†ï¼‰', 'info');
    });

    // ä¸€é”®å¡«å……æœ¬åœ°é…ç½®
    document.getElementById('quick-fill-btn').addEventListener('click', () => {
      document.getElementById('endpoint').value = 'http://localhost:8080';
      document.getElementById('appId').value = 'vanilla-example-app-id';
      document.getElementById('appName').value = 'Vanilla Example';
      document.getElementById('userId').value = 'user-dev-' + Math.floor(Math.random() * 10000);
      log('å·²å¡«å……æœ¬åœ°å¼€å‘é…ç½®', 'success');
    });

    // éšæœºç”¨æˆ· ID
    document.getElementById('random-user-btn').addEventListener('click', () => {
      document.getElementById('userId').value = 'user-' + Math.random().toString(36).slice(2, 8);
      log('å·²ç”Ÿæˆéšæœºç”¨æˆ· ID', 'success');
    });

    // æ¨¡æ‹Ÿç¦»çº¿
    const original = { sendBeacon: null, fetch: null };
    const setOffline = (offline) => {
      if (offline) {
        if (original.sendBeacon === null) original.sendBeacon = navigator.sendBeacon?.bind(navigator) || null;
        if (original.fetch === null) original.fetch = window.fetch?.bind(window) || null;
        navigator.sendBeacon = () => false;
        window.fetch = async () => { throw new Error('Network offline (mock)'); };
        log('å·²å¼€å¯æ¨¡æ‹Ÿç¦»çº¿æ¨¡å¼', 'info');
      } else {
        if (original.sendBeacon) navigator.sendBeacon = original.sendBeacon;
        if (original.fetch) window.fetch = original.fetch;
        log('å·²å…³é—­æ¨¡æ‹Ÿç¦»çº¿æ¨¡å¼', 'info');
      }
    };

    const offlineToggle = document.getElementById('offline-toggle');
    offlineToggle.addEventListener('change', (e) => {
      setOffline(e.target.checked);
    });

    // æ‰¹é‡ä¸ŠæŠ¥ 3 ä¸ªäº‹ä»¶
    document.getElementById('batch-events-btn').addEventListener('click', () => {
      const now = Date.now();
      const items = [
        { id: 'batch_event_1', props: { idx: 1, ts: now } },
        { id: 'batch_event_2', props: { idx: 2, ts: now + 1 } },
        { id: 'batch_event_3', props: { idx: 3, ts: now + 2 } },
      ];
      items.forEach((it) => window.TrackSDK.track(it.id, it.props));
      log('å·²è§¦å‘ 3 ä¸ªè‡ªå®šä¹‰äº‹ä»¶ç”¨äºæ‰¹é‡ä¸ŠæŠ¥', 'success');
    });

    // æ¸…ç©ºæ—¥å¿—
    document.getElementById('clear-log-btn').addEventListener('click', clearLog);

    // é¡µé¢åŠ è½½å®Œæˆ
    log('é¡µé¢åŠ è½½å®Œæˆï¼Œç­‰å¾…åˆå§‹åŒ– SDK...', 'info');
    log('æç¤ºï¼šè¯·å…ˆé…ç½® SDK å‚æ•°ï¼Œç„¶åç‚¹å‡»"åˆå§‹åŒ– SDK"', 'info');
    // é»˜è®¤ä½¿ç”¨å½“å‰åŸŸåä½œä¸º endpoint
    try {
      document.getElementById('endpoint').value = window.location.origin;
    } catch (e) {}
  </script>
</body>

</html>